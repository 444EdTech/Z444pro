{"ast":null,"code":"var _jsxFileName = \"D:\\\\SAI DT\\\\Z444\\\\Z444pro\\\\src\\\\components\\\\UserManagement.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useContext } from 'react';\nimport { supabase } from '../supabase';\nimport { UserContext } from '../contexts/UserContext';\nimport Swal from 'sweetalert2';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction UserManagement() {\n  _s();\n  const [users, setUsers] = useState([]);\n  const {\n    user\n  } = useContext(UserContext);\n  useEffect(() => {\n    fetchUsers();\n  }, []);\n  async function fetchUsers() {\n    try {\n      const {\n        data: learners,\n        error: learnersError\n      } = await supabase.from('learnersDB').select('id, user_name, email, name').order('name');\n      const {\n        data: guides,\n        error: guidesError\n      } = await supabase.from('guidesDB').select('id, user_name, email, name').order('name');\n      if (learnersError) throw learnersError;\n      if (guidesError) throw guidesError;\n      const allUsers = [...learners.map(l => ({\n        ...l,\n        role: 'learner'\n      })), ...guides.map(g => ({\n        ...g,\n        role: 'guide'\n      }))];\n      setUsers(allUsers);\n    } catch (error) {\n      console.error('Error fetching users:', error);\n      Swal.fire('Error', 'Failed to fetch users', 'error');\n    }\n  }\n  async function handleDeleteUser(id, role) {\n    const result = await Swal.fire({\n      title: 'Are you sure?',\n      text: \"You won't be able to revert this!\",\n      icon: 'warning',\n      showCancelButton: true,\n      confirmButtonColor: '#3085d6',\n      cancelButtonColor: '#d33',\n      confirmButtonText: 'Yes, delete it!'\n    });\n    if (result.isConfirmed) {\n      try {\n        const {\n          error\n        } = await supabase.from(role === 'learner' ? 'learnersDB' : 'guidesDB').delete().eq('id', id);\n        if (error) throw error;\n        setUsers(users.filter(user => user.id !== id));\n        Swal.fire('Deleted!', 'The user has been deleted.', 'success');\n      } catch (error) {\n        console.error('Error deleting user:', error);\n        Swal.fire('Error', 'Failed to delete user', 'error');\n      }\n    }\n  }\n  if (!user || user.role !== 'admin') {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: \"Access Denied\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 12\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"container mt-5\",\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"User Management\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"table\", {\n      className: \"table table-striped table-dark mt-4\",\n      children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n        children: /*#__PURE__*/_jsxDEV(\"tr\", {\n          children: [/*#__PURE__*/_jsxDEV(\"th\", {\n            children: \"Name\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 80,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n            children: \"Username\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 81,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n            children: \"Email\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 82,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n            children: \"Role\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 83,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n            children: \"Actions\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 84,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 79,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n        children: users.map(user => /*#__PURE__*/_jsxDEV(\"tr\", {\n          children: [/*#__PURE__*/_jsxDEV(\"td\", {\n            children: user.name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 90,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n            children: user.user_name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 91,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n            children: user.email\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 92,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n            children: user.role\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 93,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n            children: /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"btn btn-danger btn-sm\",\n              onClick: () => handleDeleteUser(user.id, user.role),\n              children: \"Delete\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 95,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 94,\n            columnNumber: 15\n          }, this)]\n        }, user.id, true, {\n          fileName: _jsxFileName,\n          lineNumber: 89,\n          columnNumber: 13\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 75,\n    columnNumber: 5\n  }, this);\n}\n_s(UserManagement, \"YKLLbN6+cOn3slha3RW7KSVHcN8=\");\n_c = UserManagement;\nexport default UserManagement;\nvar _c;\n$RefreshReg$(_c, \"UserManagement\");","map":{"version":3,"names":["React","useState","useEffect","useContext","supabase","UserContext","Swal","jsxDEV","_jsxDEV","UserManagement","_s","users","setUsers","user","fetchUsers","data","learners","error","learnersError","from","select","order","guides","guidesError","allUsers","map","l","role","g","console","fire","handleDeleteUser","id","result","title","text","icon","showCancelButton","confirmButtonColor","cancelButtonColor","confirmButtonText","isConfirmed","delete","eq","filter","children","fileName","_jsxFileName","lineNumber","columnNumber","className","name","user_name","email","onClick","_c","$RefreshReg$"],"sources":["D:/SAI DT/Z444/Z444pro/src/components/UserManagement.jsx"],"sourcesContent":["import React, { useState, useEffect, useContext } from 'react';\r\nimport { supabase } from '../supabase';\r\nimport { UserContext } from '../contexts/UserContext';\r\nimport Swal from 'sweetalert2';\r\n\r\nfunction UserManagement() {\r\n  const [users, setUsers] = useState([]);\r\n  const { user } = useContext(UserContext);\r\n\r\n  useEffect(() => {\r\n    fetchUsers();\r\n  }, []);\r\n\r\n  async function fetchUsers() {\r\n    try {\r\n      const { data: learners, error: learnersError } = await supabase\r\n        .from('learnersDB')\r\n        .select('id, user_name, email, name')\r\n        .order('name');\r\n\r\n      const { data: guides, error: guidesError } = await supabase\r\n        .from('guidesDB')\r\n        .select('id, user_name, email, name')\r\n        .order('name');\r\n\r\n      if (learnersError) throw learnersError;\r\n      if (guidesError) throw guidesError;\r\n\r\n      const allUsers = [\r\n        ...learners.map(l => ({ ...l, role: 'learner' })),\r\n        ...guides.map(g => ({ ...g, role: 'guide' }))\r\n      ];\r\n\r\n      setUsers(allUsers);\r\n    } catch (error) {\r\n      console.error('Error fetching users:', error);\r\n      Swal.fire('Error', 'Failed to fetch users', 'error');\r\n    }\r\n  }\r\n\r\n  async function handleDeleteUser(id, role) {\r\n    const result = await Swal.fire({\r\n      title: 'Are you sure?',\r\n      text: \"You won't be able to revert this!\",\r\n      icon: 'warning',\r\n      showCancelButton: true,\r\n      confirmButtonColor: '#3085d6',\r\n      cancelButtonColor: '#d33',\r\n      confirmButtonText: 'Yes, delete it!'\r\n    });\r\n\r\n    if (result.isConfirmed) {\r\n      try {\r\n        const { error } = await supabase\r\n          .from(role === 'learner' ? 'learnersDB' : 'guidesDB')\r\n          .delete()\r\n          .eq('id', id);\r\n\r\n        if (error) throw error;\r\n\r\n        setUsers(users.filter(user => user.id !== id));\r\n        Swal.fire('Deleted!', 'The user has been deleted.', 'success');\r\n      } catch (error) {\r\n        console.error('Error deleting user:', error);\r\n        Swal.fire('Error', 'Failed to delete user', 'error');\r\n      }\r\n    }\r\n  }\r\n\r\n  if (!user || user.role !== 'admin') {\r\n    return <div>Access Denied</div>;\r\n  }\r\n\r\n  return (\r\n    <div className=\"container mt-5\">\r\n      <h2>User Management</h2>\r\n      <table className=\"table table-striped table-dark mt-4\">\r\n        <thead>\r\n          <tr>\r\n            <th>Name</th>\r\n            <th>Username</th>\r\n            <th>Email</th>\r\n            <th>Role</th>\r\n            <th>Actions</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          {users.map((user) => (\r\n            <tr key={user.id}>\r\n              <td>{user.name}</td>\r\n              <td>{user.user_name}</td>\r\n              <td>{user.email}</td>\r\n              <td>{user.role}</td>\r\n              <td>\r\n                <button\r\n                  className=\"btn btn-danger btn-sm\"\r\n                  onClick={() => handleDeleteUser(user.id, user.role)}\r\n                >\r\n                  Delete\r\n                </button>\r\n              </td>\r\n            </tr>\r\n          ))}\r\n        </tbody>\r\n      </table>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default UserManagement;\r\n\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}